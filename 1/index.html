<!DOCTYPE html>
<html>
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <title>Color Image Reconstruction - Project 1</title>
    <style>
        :root {
            --dark-purple: #1e1a2b;
            --medium-purple: #352d4d;
            --light-purple: #574f7d;
            --accent-purple: #7b6c9e;
            --beige: #f5f0e1;
            --light-beige: #fffaf0;
            --dark-beige: #e8e0cc;
        }
        
        body {
            font-family: 'Fira Code', monospace;
            margin: 0;
            padding: 0;
            background-color: var(--dark-purple);
            color: var(--beige);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--medium-purple);
            color: var(--light-beige);
            padding: 40px 0;
            text-align: center;
            border-bottom: 3px solid var(--accent-purple);
            margin-bottom: 30px;
        }
        
        h1 {
            margin: 0;
            font-size: 2.2rem;
            font-weight: 700;
            letter-spacing: -1px;
            color: var(--light-beige);
            padding: 20px;
            text-transform: capitalize;
        }
        
        h2 {
            color: var(--accent-purple);
            border-bottom: 2px solid var(--accent-purple);
            padding-bottom: 10px;
            margin-top: 40px;
            text-transform: capitalize;
        }
        
        h3 {
            color: var(--light-beige);
            margin-top: 30px;
            font-size: 1.3rem;
        }
        
        p {
            margin-bottom: 20px;
        }
        
        .back-link {
            display: inline-block;
            margin: 20px 0;
            color: var(--accent-purple);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .back-link:hover {
            color: var(--light-beige);
        }
        
        img {
            max-width: 100%;
            border-radius: 5px;
            border: 2px solid var(--accent-purple);
            margin: 10px 0;
        }
        
        .image-with-caption {
            margin: 20px 0;
            text-align: center;
        }
        
        .image-with-caption img {
            max-width: 70%;
            display: block;
            margin: 0 auto;
        }
        
        .image-with-caption p {
            margin-top: 10px;
            font-style: italic;
            color: var(--dark-beige);
        }
        
        .image-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .image-row img {
            max-width: 30%;
            height: auto;
        }
        
        .two-image-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .two-image-row .image-with-caption {
            flex: 0 0 45%;
            max-width: 45%;
        }
        
        .two-image-row .image-with-caption img {
            max-width: 100%;
        }
        
        .one-image-row {
            text-align: center;
            margin: 20px 0;
        }
        
        .one-image-row img {
            max-width: 70%;
            display: block;
            margin: 0 auto;
        }
        
        .one-image-row .image-with-caption {
            max-width: 70%;
            margin: 0 auto;
        }
        
        .one-image-row .image-with-caption img {
            max-width: 100%;
        }
        
        .text-container {
            background-color: var(--medium-purple);
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 3px solid var(--accent-purple);
        }
        
        .text-container div {
            margin-bottom: 10px;
            font-family: 'Fira Code', monospace;
            color: var(--light-beige);
        }
        
        .section {
            background-color: var(--medium-purple);
            border-radius: 8px;
            padding: 25px;
            margin: 40px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            border-left: 3px solid var(--accent-purple);
        }
        
        .section-title {
            display: inline-block;
            background-color: var(--accent-purple);
            color: var(--light-beige);
            padding: 8px 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--accent-purple);
            color: var(--light-beige);
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-top: 15px;
            border: none;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .btn:hover {
            background-color: var(--light-purple);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        footer {
            margin-top: 60px;
            text-align: center;
            padding: 20px;
            background-color: var(--medium-purple);
            color: var(--dark-beige);
            border-top: 2px solid var(--accent-purple);
        }
        
        .table-of-contents {
            background-color: var(--medium-purple);
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
            border-left: 3px solid var(--accent-purple);
        }
        
        .table-of-contents ul {
            list-style-type: none;
            padding-left: 10px;
        }
        
        .table-of-contents li {
            margin-bottom: 10px;
        }
        
        .table-of-contents a {
            color: var(--light-beige);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .table-of-contents a:hover {
            color: var(--accent-purple);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .two-image-row {
                flex-direction: column;
            }
            
            .two-image-row .image-with-caption {
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .image-row img {
                max-width: 100%;
            }
            
            .one-image-row img,
            .one-image-row .image-with-caption {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1><span class="code-bracket">{</span> Color Image Reconstruction <span class="code-bracket">}</span></h1>
            <div class="subtitle">// The first project of intro to computer vision course</div>
        </div>
    </header>
    
    <div class="container">
        <a href="../index.html" class="back-link">‚Üê Back to Portfolio</a>
        
        <div class="table-of-contents">
            <div class="section-title">Table of Contents</div>
            <ul>
                <li><a href="#introduction">Introduction</a></li>
                <li><a href="#approach">My Approach</a></li>
                <li><a href="#simple-implementation">Simple Implementation Results</a></li>
                <li><a href="#pyramid-implementation">Pyramid Implementation Results</a></li>
                <li><a href="#challenges">Challenges</a></li>
            </ul>
        </div>
        
        <section id="introduction" class="section">
            <div class="section-title">Introduction</div>
            <p>
                Sergei Mikhailovich Prokudin-Gorskii (1863-1944) was a man well ahead of his time. Convinced, as early as 1907, 
                that color photography was the wave of the future, he won Tzar's special permission to travel across the vast 
                Russian Empire and take color photographs of everything he saw including the only color portrait of Leo Tolstoy. 
                And he really photographed everything: people, buildings, landscapes, railroads, bridges... thousands of color 
                pictures! His idea was simple: record three exposures of every scene onto a glass plate using a red, a green, 
                and a blue filter. His RGB glass plate negatives, capturing the last years of the Russian Empire, survived and were 
                purchased in 1948 by the Library of Congress. The LoC has recently digitized the negatives and made them available on-line. 
                This project takes those negative and tries to make a colored picture using single-scale and recursive algorithms to align all 
                three images from LoC collection. (All images are downscaled to process on the page.)
            </p>
            <p>
                Here is the example of initial image:
            </p>
            <div class="one-image-row">
                <img src="./media/melons_start.jpg">
            </div>
        </section>
        
        <section id="approach" class="section">
            <div class="section-title">My Approach</div>
            <p>
                For the simple implementation I initially tried to align images without cropping them.
                It kept being slightly wrong, which, I believe, is because of the black borders. So I ended up implementing
                crop_borders function and adding it straight to the align function. To check the  
                closeness between images I used normalized cross-corellation. It is in a separate function called normalized_cross_correlation
                My align crops small part of the blue image that we are trying to align to. It then loops through the 
                x and y coordinates, rolling the source image(red/green image) pixels(represented as floats). 
                Meaning I initially roll the float, and then crop it, making it look like I am moving the cropped porion.
                In fact I roll pixels(rm the last pixels on height and width and then add them at the front). That is also 
                on of the reasons why not cropping did not work in my case. For the pyramid implementation I used the same align function,
                creating the function called align_pyramid. It is recursive, and starts from the bottom. Level 1
                does the approximately 400x400 rescaled picture. It then gets cropped in align. Then every level starts
                from shifting the source into the best shift suggested from the previous level.
            </p>
        </section>
        
        <section id="simple-implementation" class="section">
            <div class="section-title">Simple Implementation Results</div>
            <h3>Images from Simple Implementation</h3>
            <div class="image-row">
                <img src="./media/cathedral.jpg">
                <img src="./media/monastery.jpg">
                <img src="./media/tobolsk.jpg">
            </div>
            
            <div class="text-container">
                <div>Cathedral: Green channel aligned with shift: (5, 2), Red channel aligned with shift: (12, 3)</div>
                <div>Monastery: Green channel aligned with shift: (-3, 2), Red channel aligned with shift: (3, 2)</div>
                <div>Tobolsk: Green channel aligned with shift: (3, 3), Red channel aligned with shift: (6, 3)</div>
            </div>
        </section>
        
        <section id="pyramid-implementation" class="section">
            <div class="section-title">Pyramid Implementation Results</div>
            <h3>First Set of Images</h3>
            <div class="two-image-row">
                <div class="image-with-caption">
                    <img src="./media/church.jpg">
                    <p>Church: Green: (25, 4), Red: (58, -4)</p>
                </div>
                <div class="image-with-caption">
                    <img src="./media/harvesters.jpg">
                    <p>Harvesters: Green: (60, 17), Red: (124, 14)</p>
                </div>
            </div>
            
            <h3>Second Set of Images</h3>
            <div class="two-image-row">
                <div class="image-with-caption">
                    <img src="./media/icon.jpg">
                    <p>Icon: Green: (41, 17), Red: (89, 23)</p>
                </div>
                <div class="image-with-caption">
                    <img src="./media/lady.jpg">
                    <p>Lady: Green: (55, 9), Red: (117, 12)</p>
                </div>  
            </div>
            
            <h3>Third Set of Images</h3>
            <div class="two-image-row">
                <div class="image-with-caption">
                    <img src="./media/melons.jpg">
                    <p>Melons: Green: (81, 10), Red: (178, 13)</p>
                </div>
                <div class="image-with-caption">
                    <img src="./media/onion_church.jpg">
                    <p>Onion church: Green: (51, 27), Red: (108, 36)</p>
                </div>  
            </div>
            
            <h3>Fourth Set of Images</h3>
            <div class="two-image-row">
                <div class="image-with-caption">
                    <img src="./media/sculpture.jpg">
                    <p>Sculpture: Green: (33, -11), Red: (140, -27)</p>
                </div>
                <div class="image-with-caption">
                    <img src="./media/self_portrait.jpg">
                    <p>Self portrait: Green: (79, 29), Red: (176, 37)</p>
                </div>
            </div>
            
            <h3>Train Image</h3>
            <div class="one-image-row">
                <div class="image-with-caption">
                    <img src="./media/train.jpg">
                    <p>Train: Green: (43, 6), Red: (87, 32)</p>
                </div>
            </div>
        </section>
        
        <section id="challenges" class="section">
            <div class="section-title">Challenges</div>
            <h3>Images with Alignment Issues</h3>
            <p>Below are two pictures that went slightly wrong for some reason.</p>
            <div class="two-image-row">
                <div class="image-with-caption">
                    <img src="./media/three_generations.jpg">
                    <p>Three generations: Green: (53, 14), Red: (111, 11)</p>
                </div>
                <div class="image-with-caption">
                    <img src="./media/emir.jpg">
                    <p>Emir: Green: (49, 24), Red: (103, 57)</p>
                </div>
            </div>
        </section>
        
        <a href="../index.html" class="btn">Back to Portfolio</a>
        
        <footer>
            <p><span class="code-bracket">return</span> CS180 Portfolio &copy; 2023;</p>
        </footer>
    </div>
</body>
</html>
